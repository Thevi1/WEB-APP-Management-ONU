{% extends 'layout.html' %}

    {% block content %}
    <!-- Main Content -->
    <main class="main-content" style="margin-top:80px;">
        <!-- Top Navigation (judul dan tombol) -->
        <!-- ONU Table -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <h5 class="mb-0">
                    <i class="fas fa-cog me-2"></i>
                    Daftar ONU
                    <small class="text-muted">Optical Network Unit</small>
                </h5>
            </div>
            <div>
                <button class="btn btn-outline-secondary btn-sm me-2 btn-sync">
                    <i class="fas fa-sync me-1"></i> Sinkronisasi Status ONU
                </button>
                <button class="btn btn-primary btn-sm">
                    <i class="fas fa-plus me-1"></i> Tambah ONU
                </button>
            </div>
        </div>
        <div class="table-container">
            <div class="table-responsive">
                <table class="table table-dark table-hover mb-0">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Serial Number</th>
                            <th>MAC Address</th>
                            <th>Status</th>
                            <th>Distance</th>
                            <th>Temperature</th>
                            <th>RxPower</th>
                            <th>TxPower</th>
                            <th>RTT</th>
                            <th>Online Time</th>
                            <th>Offline Time</th>
                            <th>Alarms</th>
                            <th>Vendor/Model</th>
                            <th>PON/Port</th>
                            <th>IP Address</th>
                            <!-- <th>Deregister</th>
                            <th>Map</th> -->
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for onu in onus %}
                        <tr>
                            <td>{{ onu.id }}</td>
                            <td><code>{{ onu.serial_number }}</code></td>
                            <td><code>{{ onu.mac_address }}</code></td>
                            <td>
                                <span class="status-badge status-online">{{ onu.status }}</span>
                            </td>
                            <td>{{ onu.distance }}</td>
                            <td>
                                <span class="status-badge temperature-lainnya">{{ onu.temperature }}</span>
                            </td>
                            <td>
                                <span class="status-badge {% if onu.rx_power == 'Tinggi' %}power-tinggi{% else %}power-lainnya-tinggi{% endif %}">
                                    {{ onu.rx_power }}
                                </span>
                            </td>
                            <td>{{ onu.tx_power }}</td>
                            <td>{{ onu.rtt }}</td>
                            <td>{{ onu.online_time }}</td>
                            <td>{{ onu.offline_time }}</td>
                            <td>
                                <span class="status-badge status-online">{{ onu.alarms }}</span>
                            </td>
                            <td>{{ onu.vendor_model }}</td>
                            <td>{{ onu.pon_port }}</td>
                            <td>{{ onu.ip_address }}</td>
                            <!-- <td>{{ onu.deregister }}</td>
                            <td>{{ onu.map }}</td> -->
                            <td>
                                <button class="btn btn-outline-primary btn-custom">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-outline-danger btn-custom">
                                    <i class="fas fa-trash" style="padding: 0%;"></i> Hapus
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </main>
    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.tab-btn').forEach(tab => {
                    tab.classList.remove('active');
                });
                // Add active class to clicked tab
                this.classList.add('active');
            });
        });

        document.querySelectorAll('.side-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.side-btn').forEach(tab => {
                    tab.classList.remove('active');
                });
                // Add active class to clicked tab
                this.classList.add('active');
            });
        });
        // Add some interactivity to the table
        document.querySelectorAll('tr').forEach(row => {
            row.addEventListener('click', function() {
                // Remove highlight from all rows
                document.querySelectorAll('tr').forEach(r => {
                    r.style.backgroundColor = '';
                });
                // Highlight clicked row
                this.style.backgroundColor = 'rgba(88, 166, 255, 0.1)';
            });
        });
        // Auto-refresh data every 30 seconds
        setInterval(() => {
            fetch('/api/onus')
                .then(response => response.json())
                .then(data => {
                    console.log('Data refreshed:', data);
                    // You can update the table here with new data
                })
                .catch(error => console.error('Error fetching data:', error));
        }, 30000);
    </script>
    {% endblock %}
